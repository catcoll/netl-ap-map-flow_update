      MODULE APM_SOLVER_MODULE
C
C     WRITTEN BY: MATTHEW STADELMAN
C     FILE DESCRIPTION: STORES THE NEEDED VARIABLES AND CONSTANTS FOR
C     2-D LOCAL CUBIC LAW MODEL.
C
C     LAST MODIFIED: 2016/06/27
C ----------------------------------------------------------------------
C               ---- VARIABLE DESCRIPTIONS ----
C
C ----------------------------------------------------------------------
C
      PUBLIC
C
C     COEFFICENT ARRAYS
      REAL(8),ALLOCATABLE,SAVE :: CC(:),TT(:,:),RHS(:)
      REAL(8),ALLOCATABLE,SAVE :: NEUMANNG_ROW(:),NEUMANNG_COL(:)
      REAL(8),SAVE :: NEUMANNG_CC,NEUMANNG_RHS,NEUMANNG_X
C
C     WORK ARRAYS
      REAL(8),ALLOCATABLE,SAVE :: UPPER_D4(:),ROW(:)
C
C     INDEXING ARRAYS
      INTEGER,ALLOCATABLE,SAVE :: LINK_D4(:,:)
      INTEGER,ALLOCATABLE,SAVE :: INAT(:),INO(:)
      INTEGER,ALLOCATABLE,SAVE :: IBASE_UPPER(:)
C
C     COEFFICENT DATA EXTENTS
      INTEGER,SAVE :: IBR_MAX(2),X_OFFSET,Z_OFFSET,SOLV_NX,SOLV_NZ
      INTEGER,SAVE :: NUM_TOP,NUM_BOTTOM,NUM_TOTAL,MAX_BAND
C
      CONTAINS
C
C     ALLOCATES THE SOLVER'S COEFFICIENT ARRAYS
      SUBROUTINE ALLOCATE_COEF(NUM_BLK)
        IMPLICIT NONE
        INTEGER :: NUM_BLK
        !
        ALLOCATE (CC(NUM_BLK),TT(NUM_BLK,4),RHS(NUM_BLK))
        !
        RETURN
      END SUBROUTINE
C
C     DEALLOCATES THE SOLVER'S COEFFICIENT ARRAYS
      SUBROUTINE DEALLOCATE_COEF
        IMPLICIT NONE
        !
        DEALLOCATE (CC,TT,RHS,UPPER_D4,ROW,LINK_D4,INO,INAT,IBASE_UPPER)
        !
        RETURN
      END SUBROUTINE
C
      END MODULE