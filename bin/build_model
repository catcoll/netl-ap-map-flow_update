#!/bin/bash

# Determining top level of repository
REPO_HOME=""
if command -v git >/dev/null 2>&1;  then
    echo "Using git to determine repository path"
    REPO_HOME=$(git rev-parse --show-toplevel)
fi
if [ ! $REPO_HOME ]; then
    echo ""
    echo "Defaulting to assume source code is located at ./ApertureMapModelTools/src"
    REPO_HOME=$(pwd)
fi
set -e

# Building the flow model from source
cd "$REPO_HOME"
make $1 MODELNAME=apm-lcl-model.exe -C ApertureMapModelTools/src
mv ApertureMapModelTools/src/dist/apm-lcl-model.exe ApertureMapModelTools/
